
<h1 class="" style="color: white; text-align: center; margin-top: 2%;">Tus Rankings</h1>
<br>
<div class="alert alert-warning" role="alert" *ngIf="this.authService.UserData.date == undefined"
  style="width: 50%; text-align: center; margin-left: 24%;">
  No tiene ningún ranking creado.
</div>
<div class="alert alert-warning" role="alert" *ngIf="this.authService.UserData.date != undefined"
  style="width: 50%; text-align: center; margin-left: 24%;">
>>>>>>> Stashed changes
  No está suscrito a ningún ranking.
</div>
<h1 class="" style="color: white; text-align: center;">Tus Rankings</h1>
<div class="container">
  <div class="big-layout" *ngIf="this.authService.UserData.date != undefined">
    <div class="" style="color: rgb(0, 0, 0)">
      <form class="" [formGroup]="joinForm" (ngSubmit)="onSubmit()">
        <label for="rank_name">Codigo del ranking:</label><br>
        <input style="width: 230px; margin-right: 10px;" type="number" formControlName="rank_id" /><br>
        <button type="submit" class="btn btn-block btn-primary" style="margin-top: 5%;">
          Unirse al ranking
        </button><br>
      </form>
      <div class="alarma form-group alert alert-warning"  *ngIf="this.showAlertPeticion == true" role="alert" style="text-align:center;">
        Solicitud de unión <br>a ranking realizada.
      </div>
    </div>
  </div>
  <div class="big-layout" *ngIf="this.authService.UserData.date == undefined" style="color: black">
    <form class="form-signin" [formGroup]="createForm" (ngSubmit)="createRanking()">
      <div class="">
        <div class="form-group">
          <label for="rank_name">Nombre del ranking:</label>
          <input type="text" class="form-control" formControlName="rank_name" required>
        </div>
        <br>
        <div class="form-group">
          <label for="description">Descripción:</label>
          <textarea class="form-control" rows="3" formControlName="rank_description" required></textarea>
        </div>
        <br>
        <button type="submit" class="btn btn-block btn-primary">Crear Ranking</button>

        <button type="button" class="btn btn-success" (click)="verPeticiones()">Peticiones</button>

      </div>
    </form>
    <br>
  </div>
  <div class="alert alert-warning nota" role="alert" *ngIf="this.showAlertPeticion == false"
  style="text-align:center;">
  Solicitud de unión a ranking realizada.
</div>

</div>
<div *ngIf="this.authService.UserData.date == undefined">
  <div class="layout" *ngFor="let ranking of UserRankingData; let i = index">
    <table class="table " style="color: rgb(255, 255, 255)">
      <thead>
        <tr>
          <th scope="col">Codigo</th>
          <th scope="col">Nombre</th>
          <th scope="col">Points</th>
          <th scope="col">Acceder</th>
          <th scope="col">Eliminar</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let rank of RankingData" style="color:white;" scope="row">
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            {{rank.id}}</td>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            {{rank.rank_name}}</td>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            <button (click)="clickRanking(this.rank)" type="button" class="btn btn-warning">Entrar</button>
          </td>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id"><button (click)="clickRanking(this.rank)"
              type="button" class="btn btn-danger">Borrar</button></td>
        </tr>
      </tbody>
    </table>
    <div class="alert alert-warning" role="alert" *ngIf="this.showAlertRankDelete == true" style="text-align:center;">
      Ranking eliminado.
    </div>
    <div class="alert alert-warning" role="alert" *ngIf="this.showAlertRankCodeUpdated == true"
      style="text-align:center;">
      Código de ranking actualizado.
    </div>

  </div>
</div>

<div *ngIf="this.authService.UserData.date != undefined">
  <div class="layout2">
    <table class="table " style="color: rgb(255, 255, 255)">
      <thead>
        <tr>
          <th scope="col">Codigo</th>
          <th scope="col">Nombre</th>
          <th scope="col">Points</th>
          <th scope="col">Acceder</th>
        </tr>
      </thead>

      <tbody *ngFor="let ranking of UserRankingData; let i = index">
        <tr *ngFor="let rank of RankingData" style="color:white;" scope="row">
          <td
            *ngIf="this.ranking.user_id == this.authService.UserData.id">
            {{rank.id}}</td>
          <td
            *ngIf="this.ranking.user_id == this.authService.UserData.id">
            {{rank.rank_name}}</td>
          <td
            *ngIf="this.ranking.user_id == this.authService.UserData.id">
            {{ranking.points}}</td>
          <td
            *ngIf="this.ranking.user_id == this.authService.UserData.id">
            <button (click)="clickRanking(this.rank)" type="button" class="btn btn-warning">Entrar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<div class="layout2" >
  <table *ngIf="showTable == true" class="table"  style="color: rgb(255, 255, 255)">
    <thead class="thead-dark">
      <tr>
        <th scope="col">Ranking</th>
        <th scope="col">Alumno</th>
        <th scope="col">Aceptar</th>
        <th scope="col">Denegar</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let peticiones of PetitionsData">
        <td>{{peticiones.rank_code}}</td>
        <td>{{peticiones.user_id}}</td>
        <td><button class="btn btn-success" (click)="aceptarPeticion()">Aceptar</button></td>
        <td><button class="btn btn-danger" (click)="denegarPeticion()">Denegar</button></td>
      </tr>
    </tbody>
  </table>
  <div class="alert alert-success" role="alert" *ngIf="showAlertAceptada">
    Se ha aceptado una petición.
  </div>
  <div class="alert alert-danger" role="alert" *ngIf="showAlert">
    Se ha eliminado una petición.
  </div>
  <div class="alert alert-info" role="alert" *ngIf="showAlertErrorAceptada">
    Ha ocurrido un error y la petición no se ha aceptado.
  </div>
  <div class="alert alert-info" role="alert" *ngIf="showAlertError">
    Ha ocurrido un error y la petición no se ha eliminado.
  </div>
</div>
