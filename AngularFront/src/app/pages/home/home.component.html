<div *ngIf="UserRankingData.length == 0" class="alert alert-warning" role="alert">
  No está suscrito a ningún ranking.
</div>
<div class="container">
  <div class="layout">

    <div class="" *ngIf="this.authService.UserData.date != undefined " style="color: white">
      <form class="form-signin" [formGroup]="joinForm" (ngSubmit)="onSubmit()">
        <div class="col-sm-9">
          <div class="inline">
            <input style="width: 230px; margin-right: 10px;" type="number" formControlName="rank_id" />
            <button type="submit" class="btn btn-block btn-primary" style="margin-top: 5%;">
              Unirse al ranking
            </button><br>
          </div>
        </div>
      </form>
    </div>

    <div class="" *ngIf="this.authService.UserData.date == undefined" style="color: white">
      <form class="form-signin" [formGroup]="createForm" (ngSubmit)="createRanking()">
        <div class="col-sm-9">
          <div class="form-group">
            <label for="rank_name">Nombre del ranking:</label>
            <input type="text" class="form-control" formControlName="rank_name" required>
          </div>

          <div class="form-group">
            <label for="description">Descripción:</label>
            <textarea class="form-control" rows="3" formControlName="rank_description" required></textarea>
          </div>

          <button type="submit" class="btn btn-block btn-primary" style="margin-top: 5%;">
            Crear Ranking
          </button><br>
        </div>
      </form>
      <div class="tabla">
        <button class="btn btn-success" (click)="verPeticiones()">Ver/Ocultar peticiones</button>
        <br>
        <br>
        <table *ngIf="showTable == true" class="table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">Ranking</th>
              <th scope="col">Alumno</th>
              <th scope="col">Aceptar</th>
              <th scope="col">Denegar</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let peticiones of PetitionsData">
              <td>{{peticiones.rank_code}}</td>
              <!-- El ranking al que hace la peticion -->
              <td>{{peticiones.user_id}}</td>
              <!-- Usuario que hace la petición -->
              <td><button class="btn btn-success" (click)="aceptarPeticion()">Aceptar</button></td>
              <td><button class="btn btn-danger" (click)="denegarPeticion()">Denegar</button></td>
            </tr>
          </tbody>
        </table>
        <div class="alert alert-success" role="alert" *ngIf="showAlertAceptada">
          Se ha aceptado una petición.
        </div>
        <div class="alert alert-danger" role="alert" *ngIf="showAlert">
          Se ha eliminado una petición.
        </div>
        <div class="alert alert-info" role="alert" *ngIf="showAlertErrorAceptada">
          Ha ocurrido un error y la petición no se ha aceptado.
        </div>
        <div class="alert alert-info" role="alert" *ngIf="showAlertError">
          Ha ocurrido un error y la petición no se ha eliminado.
        </div>
      </div>
    </div>

  </div>
  <div class="container">
    <div *ngFor="let ranking of UserRankingData; let i = index">
      <div *ngIf="this.ranking.id != 0" class="big-layout">
        <div class="card" style="width: 18rem;">
          <div class="card-body">
            <div (click)="clickRanking(this.rank)" *ngFor="let rank of RankingData; let i = index">
              <h5 *ngIf="this.ranking.rank_code == this.rank.id" class="card-title mb-2 text-muted">
                <b>Código de ranking:</b>
                <br>
                <b>{{rank.id}}</b>
                <br>
                <b> {{rank.rank_name}}</b>
              </h5>
            </div>
            <h6 *ngIf="this.authService.UserData.date != undefined" class="card-subtitle mb-2 text-muted">Puntos:
              {{this.ranking.points}}</h6>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
