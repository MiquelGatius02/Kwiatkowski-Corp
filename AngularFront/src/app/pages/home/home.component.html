<h1 class="" style="color: white; text-align: center; margin-top: 2%;">Tus Rankings</h1>
<br>
<div class="container">
  <div class="big-layout" *ngIf="this.authService.UserData.date != undefined">
    <div class="" style="color: rgb(0, 0, 0)">
      <form class="" [formGroup]="joinForm" (ngSubmit)="onSubmit()">
        <label for="rank_name">Codigo del ranking:</label><br>
        <input style="width: 230px; margin-right: 10px;" type="number" formControlName="rank_id" /><br>
        <button type="submit" class="btn btn-block btn-primary" style="margin-top: 5%;" data-toggle="modal" data-target="#modal1">
          Unirse al ranking
        </button>
        <br>
      </form>
    </div>
  </div>
  <div class="big-layout"  *ngIf="this.authService.UserData.date == undefined" style="color: black">
    <form [formGroup]="createForm" (ngSubmit)="createRanking()">
      <div>
        <div class="form-group">
          <label for="rank_name">Nombre del ranking:</label>
          <input type="text" class="form-control" formControlName="rank_name" required>
        </div>
        <br>
        <div class="form-group">
          <label for="description">Descripción:</label>
          <textarea class="form-control" rows="3" formControlName="rank_description" required></textarea>
        </div>
        <br>
        <button type="submit" class="btn btn-block btn-primary"  data-toggle="modal" data-target="#modal2">Crear Ranking</button>
      </div>
    </form>
    <br>
  </div>
</div>


<div *ngIf="this.authService.UserData.date == undefined">
  <div class="layout" *ngFor="let ranking of UserRankingData; let i = index">
    <table class="table " style="color: rgb(255, 255, 255)">
      <thead>
        <tr>
          <th scope="col">Codigo</th>
          <th scope="col">Nombre</th>
          <th scope="col">Acceder</th>
          <th scope="col">Eliminar</th>
          <th scope="col">Generar Codigo</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let rank of RankingData" style="color:white;" scope="row">
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            {{rank.id}}</td>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            {{rank.rank_name}}</td>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            <button (click)="clickRanking(this.rank)" type="button" class="btn btn-warning">Entrar</button>
          </td>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            <button (click)="eliminarRanking(this.rank)" type="button" class="btn btn-danger" data-toggle="modal" data-target="#modal3">Borrar</button>
          <td *ngIf="this.rank.id_creador == this.authService.UserData.id">
            <button (click)="regenerarCodigo(this.rank)" type="button" class="btn btn-success" data-toggle="modal" data-target="#modal4">Generar</button>
          </td>
        </tr>
        <br>
      </tbody>
    </table>
    <div class="alert alert-warning" role="alert" *ngIf="this.showAlertRankDelete == true" style="text-align:center;">
      Ranking eliminado.
    </div>
    <div class="alert alert-warning" role="alert" *ngIf="this.showAlertRankCodeUpdated == true"
      style="text-align:center;">
      Código de ranking actualizado.
    </div>
  </div>
</div>

<div *ngIf="this.authService.UserData.date != undefined">
  <div class="layout2">
    <table class="table " style="color: rgb(255, 255, 255)">
      <thead>
        <tr>
          <th scope="col">Codigo</th>
          <th scope="col">Nombre</th>
          <th scope="col">Points</th>
          <th scope="col">Acceder</th>
        </tr>
      </thead>

      <tbody *ngFor="let ranking of UserRankingData; let i = index">
        <tr *ngFor="let rank of RankingData" style="color:white;" scope="row">
          <td *ngIf="this.ranking.rank_code == this.rank.id && this.ranking.rank_code != 0">
            {{rank.id}}</td>
          <td *ngIf="this.ranking.rank_code == this.rank.id && this.ranking.rank_code != 0">
            {{rank.rank_name}}</td>
          <td *ngIf="this.ranking.rank_code == this.rank.id && this.ranking.rank_code != 0">
            {{ranking.points}}</td>
          <td *ngIf="this.ranking.rank_code == this.rank.id && this.ranking.rank_code != 0">
            <button (click)="clickRanking(this.rank)" type="button" class="btn btn-warning">Entrar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div id="modal1" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Se ha enviado solicitud para unirse al ranking</h5>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" data-dismiss="modal">Aceptar</button>
      </div>
    </div>
  </div>
</div>

<div id="modal2" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Se ha creado un ranking</h5>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" data-dismiss="modal">Aceptar</button>
      </div>
    </div>
  </div>
</div>

<div id="modal3" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Se ha eliminado el ranking</h5>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" data-dismiss="modal">Aceptar</button>
      </div>
    </div>
  </div>
</div>
<div id="modal4" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Se ha generado un nuevo codigo</h5>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" data-dismiss="modal">Aceptar</button>
      </div>
    </div>
  </div>
</div>
